{"version":3,"file":"js/src_views_NewTopic_vue.js","mappings":";;;;;;;;;;;;;AACA;AACA;AACA;AAGA,+DAAeA,oDAAe,CAAC;AAC7BG,MAAI;AACF,UAAMC,KAAK,GAA+B,EAA1C;AACA,UAAMC,KAAK,GAAiC,EAA5C;AACA,UAAMC,aAAa,GAAa,EAAhC,CAHE,CAIF;;AACA,UAAMC,YAAY,GAAG,EAArB;AACA,WAAO;AACLC,WAAK,EAAE,EADF;AAELJ,WAFK;AAGLC,WAHK;AAILC,mBAJK;AAKL;AACAC,kBANK;AAOLE,aAAO,EAAE;AAPJ,KAAP;AASD,GAhB4B;;AAiB7B,QAAMC,OAAN,GAAa;AACX,UAAMC,YAAY,GAAG,IAAIT,gEAAJ,EAArB;AACA,SAAKE,KAAL,GAAa,MAAMO,YAAY,CAACC,WAAb,EAAnB;AACA,SAAKP,KAAL,GAAa,MAAMM,YAAY,CAACE,WAAb,EAAnB;AACD,GArB4B;;AAsB7BC,SAAO,EAAE;AACPC,sBAAkB;AAChB,aAAO,KAAKT,aAAL,CAAmBU,MAAnB,GAA4B,CAA5B,IAAiC,KAAKR,KAAL,KAAe,EAAvD;AACD,KAHM;;AAIP,UAAMS,WAAN,GAAiB;AACf,YAAMC,MAAM,GAAG,KAAKd,KAAL,CACZe,MADY,CACJC,CAAD,IAAO,KAAKd,aAAL,CAAmBe,QAAnB,CAA4BD,CAAC,CAACE,GAA9B,CADF,EAEZC,OAFY,CAEHH,CAAD,IACPI,MAAM,CAACC,IAAP,CAAYL,CAAC,CAACM,kBAAF,GAAuBN,CAAC,CAACM,kBAAzB,GAA8C,EAA1D,CAHW,CAAf;;AAKA,UAAI,KAAKlB,KAAL,KAAe,EAAf,IAAqBU,MAAM,CAACF,MAAP,GAAgB,CAAzC,EAA4C;AAC1C,aAAKP,OAAL,GAAe,IAAf;AACA,cAAM,IAAIR,8EAAJ,GAA0B0B,UAA1B,CAAqCT,MAArC,EAA6C,KAAKV,KAAlD,CAAN;AACA,cAAM,IAAIN,gEAAJ,GAAmB0B,SAAnB,CAA6B,KAAKpB,KAAlC,EAAyCU,MAAzC,CAAN;AACA,aAAKT,OAAL,GAAe,KAAf;AACA,aAAKoB,OAAL,CAAaC,IAAb;AACD;AACF,KAjBM;;AAkBPC,kBAAc,CAACC,EAAD,EAAaC,IAAb,EAA2B;AACvC,YAAMC,CAAC,GAAGD,IAAI,CAACE,OAAL,CAAaH,EAAb,CAAV;;AACA,UAAIE,CAAC,IAAI,CAAT,EAAY;AACVD,YAAI,CAACG,MAAL,CAAYF,CAAZ,EAAe,CAAf;AACD,OAFD,MAEO;AACLD,YAAI,CAACI,IAAL,CAAUL,EAAV;AACD;AACF,KAzBM;;AA0BPM,cAAU,CAACC,IAAD,EAAa;AACrB;AACA;AACA;AACA;AACA,UAAI,KAAKhC,YAAL,KAAsBgC,IAA1B,EAAgC;AAC9B,aAAKhC,YAAL,GAAoB,EAApB;AACA,aAAKD,aAAL,GAAqB,EAArB;AACD,OAHD,MAGO;AACL,aAAKC,YAAL,GAAoBgC,IAApB;AACA,aAAKjC,aAAL,GAAqB,KAAKD,KAAL,CAAWkC,IAAX,CAArB;AACD;AACF;;AAtCM;AAtBoB,CAAD,CAA9B;;;;;;;;;;;;;;;;ACNA;;AAEA,MAAMiB,YAAY,GAAGC,CAAC,KAAKJ,gDAAY,CAAC,iBAAD,CAAZ,EAAgCI,CAAC,GAACA,CAAC,EAAnC,EAAsCF,+CAAW,EAAjD,EAAoDE,CAAzD,CAAtB;;AACA,MAAMC,UAAU,GAAG;AAAEC,IAAE,EAAE;AAAN,CAAnB;AACA,MAAMC,UAAU,GAAG;AAAEC,OAAK,EAAE;AAAT,CAAnB;AACA,MAAMC,UAAU,GAAG;AAAED,OAAK,EAAE;AAAT,CAAnB;AACA,MAAME,UAAU,GAAG,CAAC,UAAD,EAAa,SAAb,CAAnB;;AACA,MAAMC,UAAU,GAAG,aAAcR,YAAY,CAAC,MAAM,aAAab,uDAAmB,CAAC,KAAD,EAAQ;AAAEkB,OAAK,EAAE;AAAT,CAAR,EAA8B,IAA9B,EAAoC,CAAC;AAAE;AAAvC,CAAvC,CAA7C;;AACA,MAAMI,UAAU,GAAG;AAAEJ,OAAK,EAAE;AAAT,CAAnB;AACA,MAAMK,UAAU,GAAG,CAAC,UAAD,EAAa,SAAb,CAAnB;AACA,MAAMC,UAAU,GAAG;AAAEN,OAAK,EAAE;AAAT,CAAnB;AACA,MAAMO,UAAU,GAAG,CAAC,UAAD,EAAa,SAAb,CAAnB;AAEM,SAAUC,MAAV,CAAiBC,IAAjB,EAA2BC,MAA3B,EAAuCC,MAAvC,EAAmDC,MAAnD,EAA+DC,KAA/D,EAA0EC,QAA1E,EAAuF;AAC3F,SAAQ1B,8CAAU,IAAIE,uDAAmB,CAAC,KAAD,EAAQO,UAAR,EAAoB,CAC3Df,uDAAmB,CAAC,KAAD,EAAQiB,UAAR,EAAoBnB,oDAAgB,CAAC6B,IAAI,CAACM,EAAL,CAAQxE,KAAT,CAApC,EAAqD;AAAE;AAAvD,GADwC,EAE3DuC,uDAAmB,CAAC,KAAD,EAAQmB,UAAR,EAAoB,EACpCb,8CAAU,CAAC,IAAD,CAAV,EAAkBE,uDAAmB,CAACJ,yCAAD,EAAY,IAAZ,EAAkBF,+CAAW,CAACyB,IAAI,CAAClE,KAAN,EAAcyE,IAAD,IAAS;AACvF,WAAQ5B,8CAAU,IAAIE,uDAAmB,CAAC,KAAD,EAAQ;AAC/CU,WAAK,EAAE,UADwC;AAE/CiB,SAAG,EAAED,IAAI,CAACvD,GAFqC;AAG/CyD,cAAQ,EAAE,KAAKzE,aAAL,CAAmBe,QAAnB,CAA4BwD,IAAI,CAACvD,GAAjC,CAHqC;AAI/C0D,aAAO,EAAGC,MAAD,IAAkBX,IAAI,CAACvC,cAAL,CAAoB8C,IAAI,CAACvD,GAAzB,EAA8B,KAAKhB,aAAnC;AAJoB,KAAR,EAKtCmC,oDAAgB,CAACoC,IAAI,CAACK,IAAL,GAAYL,IAAI,CAACK,IAAL,CAAUC,IAAtB,GAA6BN,IAAI,CAACvD,GAAnC,CALsB,EAKmB;AAAE;AALrB,MAKwCyC,UALxC,CAAzC;AAMD,GAPkE,CAA7B,EAOlC;AAAI;AAP8B,GADD,EAApB,CAFwC,EAY3DC,UAZ2D,EAa3DrB,uDAAmB,CAAC,KAAD,EAAQsB,UAAR,EAAoB,EACpChB,8CAAU,CAAC,IAAD,CAAV,EAAkBE,uDAAmB,CAACJ,yCAAD,EAAY,IAAZ,EAAkBF,+CAAW,CAACyB,IAAI,CAACjE,KAAN,EAAa,CAACkC,IAAD,EAAOuC,GAAP,KAAc;AAC5F,WAAQ7B,8CAAU,IAAIE,uDAAmB,CAAC,KAAD,EAAQ;AAC/CU,WAAK,EAAE,UADwC;AAE/CiB,SAAG,EAAEvC,IAF0C;AAG/CwC,cAAQ,EAAE,KAAKxE,YAAL,KAAsBuE,GAHe;AAI/CE,aAAO,EAAGC,MAAD,IAAkBX,IAAI,CAAChC,UAAL,CAAgBwC,GAAhB;AAJoB,KAAR,EAKtCrC,oDAAgB,CAACqC,GAAD,CALsB,EAKf;AAAE;AALa,MAKMZ,UALN,CAAzC;AAMD,GAPkE,CAA7B,EAOlC;AAAI;AAP8B,GADD,EAApB,CAbwC,EAuB3DvB,uDAAmB,CAAC,KAAD,EAAQwB,UAAR,EAAoB1B,oDAAgB,CAAC6B,IAAI,CAACM,EAAL,CAAQpE,KAAT,CAApC,EAAqD;AAAE;AAAvD,GAvBwC,EAwB3DmC,uDAAmB,CAAC,KAAD,EAAQ;AACzBkB,SAAK,EAAE,OADkB;AAEzBuB,mBAAe,EAAE,MAFQ;AAGzBC,aAAS,EAAE,MAHc;AAIzBC,WAAO,EAAEf,MAAM,CAAC,CAAD,CAAN,KAAcA,MAAM,CAAC,CAAD,CAAN,GAAaU,MAAD,IAAkBX,IAAI,CAAC9D,KAAL,GAAayE,MAAM,CAACM,MAAP,CAAcC,SAAvE;AAJgB,GAAR,EAKhB,IALgB,EAKV;AAAG;AALO,GAxBwC,EA8B3D7C,uDAAmB,CAAC,KAAD,EAAQ;AACzBkB,SAAK,EAAE,eADkB;AAEzBmB,WAAO,EAAET,MAAM,CAAC,CAAD,CAAN,KAAcA,MAAM,CAAC,CAAD,CAAN,GAC7B;AACA,KAAC,GAAGkB,IAAJ,KAAcnB,IAAI,CAACrD,WAAL,IAAoBqD,IAAI,CAACrD,WAAL,CAAiB,GAAGwE,IAApB,CAFnB,CAFgB;AAKzBC,YAAQ,EAAE,CAACpB,IAAI,CAACvD,kBAAL,EALc;AAMzBN,WAAO,EAAE6D,IAAI,CAAC7D;AANW,GAAR,EAOhBgC,oDAAgB,CAAC6B,IAAI,CAACM,EAAL,CAAQe,QAAT,CAPA,EAOoB;AAAE;AAPtB,IAOyCvB,UAPzC,CA9BwC,CAApB,CAAzC;AAuCD;;;;;;;;;;;;;;;;ACpDD;AAEM,MAAOlE,YAAP,CAAmB;AAGrB;AAEA2F;AACI,SAAKC,EAAL,GAAU,IAAIF,iEAAJ,EAAV,CADJ,CAEI;AACH;;AAEgB,QAAXhF,WAAW;AACb,UAAMmF,GAAG,GAAG,MAAM,KAAKD,EAAL,CAAQE,QAAR,CAA0C,OAA1C,CAAlB;AACA,UAAM5F,KAAK,GAAG,EAAd;;AACA,QAAI2F,GAAJ,EAAS;AACL,WAAK,MAAMzE,GAAX,IAAkByE,GAAlB,EAAuB;AACnB,cAAMlB,IAAI,GAAG,EAAE,GAAGkB,GAAG,CAACzE,GAAD,CAAR;AAAeA;AAAf,SAAb;AACAlB,aAAK,CAACiC,IAAN,CAAWwC,IAAX;AACH;AACJ;;AACD,WAAOzE,KAAP;AACH;;AAEiB,QAAZ6F,YAAY;AACd,UAAMF,GAAG,GAAG,MAAM,KAAKD,EAAL,CAAQE,QAAR,CAA4C,sBAA5C,CAAlB;;AACA,QAAID,GAAJ,EAAS;AACL,aAAOvE,MAAM,CAACC,IAAP,CAAYsE,GAAZ,CAAP;AACH;;AACD,WAAO,EAAP;AACH;;AAEgB,QAAXlF,WAAW;AACb,UAAMR,KAAK,GAAG,MAAM,KAAKyF,EAAL,CAAQE,QAAR,CAAiD,aAAjD,CAApB;AACA,UAAME,cAAc,GAAiC,EAArD;;AACA,QAAI7F,KAAJ,EAAW;AACP,WAAK,MAAMkC,IAAX,IAAmBlC,KAAnB,EAA0B;AACtB6F,sBAAc,CAAC3D,IAAD,CAAd,GAAuBf,MAAM,CAACC,IAAP,CAAYpB,KAAK,CAACkC,IAAD,CAAjB,CAAvB;AACH;AACJ;;AACD,WAAO2D,cAAP;AACH;;AAEDC,oBAAkB,CAAC/F,KAAD,EAAc;AAC5B,WAAOA,KAAK,CAACmB,OAAN,CAAesD,IAAD,IAAS;AAC1B,UAAIA,IAAI,CAACnD,kBAAT,EAA6B;AACzB,eAAOF,MAAM,CAACC,IAAP,CAAYoD,IAAI,CAACnD,kBAAjB,CAAP;AACH;AACJ,KAJM,CAAP;AAKH;;AAEc,QAATE,SAAS,CAACpB,KAAD,EAAgBU,MAAhB,EAAgC;AAC3C,UAAMkF,QAAQ,GAA8BlF,MAAM,CAACmF,MAAP,CACxC,CAACC,IAAD,EAAkCC,CAAlC,MAAyC,EAAE,GAAGD,IAAL;AAAW,OAACC,CAAD,GAAK;AAAhB,KAAzC,CADwC,EAC0B,EAD1B,CAA5C;AAGA,SAAKT,EAAL,CAAQU,SAAR,CAA6C,wBAAwBhG,KAAK,EAA1E,EAA8E4F,QAA9E;AACH;;AAtDoB;;;;;;;;;;;;;;;ACDnB,MAAOnG,mBAAP,CAA0B;AAEN,QAAhBwG,gBAAgB,CAACC,OAAD,EAAiB;AACnC,UAAMC,SAAS,GAAG,IAAIC,OAAJ,EAAlB;AACAD,aAAS,CAACE,MAAV,CAAiB,cAAjB,EAAiC,kBAAjC;AAEA,UAAMC,GAAG,GAAGC,IAAI,CAACC,SAAL,CAAeN,OAAf,CAAZ;AAEA,UAAMO,cAAc,GAAG;AACnBC,YAAM,EAAE,MADW;AAEnBC,aAAO,EAAER,SAFU;AAGnBS,UAAI,EAAEN;AAHa,KAAvB;AAMA,UAAMf,GAAG,GAAG,MAAMsB,KAAK,CAAC,qEAAD,EAAwEJ,cAAxE,CAAvB;AACA,WAAO,MAAMlB,GAAG,CAACuB,IAAJ,EAAb;AAEH;;AAEe,QAAV3F,UAAU,CAACT,MAAD,EAAmBV,KAAnB,EAAgC;AAC5C,UAAMmG,SAAS,GAAG,IAAIC,OAAJ,EAAlB;AACAD,aAAS,CAACE,MAAV,CAAiB,cAAjB,EAAiC,kBAAjC;AAEA,UAAMC,GAAG,GAAGC,IAAI,CAACC,SAAL,CAAe;AAAC9F,YAAD;AAASV;AAAT,KAAf,CAAZ;AAEA,UAAMyG,cAAc,GAAG;AACnBC,YAAM,EAAE,MADW;AAEnBC,aAAO,EAAER,SAFU;AAGnBS,UAAI,EAAEN;AAHa,KAAvB;AAMA,UAAMf,GAAG,GAAG,MAAMsB,KAAK,CAAC,2EAAD,EAA8EJ,cAA9E,CAAvB;AACA,WAAO,MAAMlB,GAAG,CAACuB,IAAJ,EAAb;AACH;;AAjC2B;;;;;;;;;;;;;;;;ACFhC;AACkH;AACtB;AAC5F,8BAA8B,mFAA2B,CAAC,8FAAwC;AAClG;AACA,uEAAuE,kBAAkB,2BAA2B,GAAG,qCAAqC,gBAAgB,qBAAqB,2BAA2B,GAAG,wCAAwC,kCAAkC,qBAAqB,GAAG,sCAAsC,8BAA8B,uBAAuB,iBAAiB,gBAAgB,sBAAsB,6BAA6B,kBAAkB,GAAG,qFAAqF,kBAAkB,oBAAoB,GAAG,yGAAyG,8BAA8B,uBAAuB,iBAAiB,gBAAgB,oBAAoB,GAAG,uIAAuI,8HAA8H,eAAe,8BAA8B,8BAA8B,mBAAmB,GAAG;AAC/rC;AACA,+DAAe,uBAAuB,EAAC;;;;;;;;;;;;;;;;;ACPkD;AAC9B;AACL;;AAEtD,CAAgF;;AAE6C;AAC7H,iCAAiC,2IAAe,CAAC,6EAAM,aAAa,mGAAM;AAC1E;AACA,IAAI,KAAU,EAAE,EAYf;;;AAGD,+DAAe;;;;;;;;;;;;;;;;ACxB+N;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AGA9O;;AAEA;AACA,cAAc,mBAAO,CAAC,sxBAA8Y;AACpa;AACA;AACA;AACA;AACA,UAAU,6JAA8E;AACxF,8CAA8C,qCAAqC;AACnF;AACA,GAAG,KAAU,EAAE","sources":["webpack://protezione-civile/./src/views/NewTopic.vue?d7cd","webpack://protezione-civile/./src/views/NewTopic.vue?f0eb","webpack://protezione-civile/./src/services/AdminService.ts","webpack://protezione-civile/./src/services/NotificationService.ts","webpack://protezione-civile/./src/views/NewTopic.vue?f44d","webpack://protezione-civile/./src/views/NewTopic.vue","webpack://protezione-civile/./src/views/NewTopic.vue?2bc8","webpack://protezione-civile/./src/views/NewTopic.vue?29d8","webpack://protezione-civile/./src/views/NewTopic.vue?c710","webpack://protezione-civile/./src/views/NewTopic.vue?552d"],"sourcesContent":["\nimport { defineComponent } from \"vue\";\nimport { NotificationService } from \"@/services/NotificationService\";\nimport { AdminService } from \"@/services/AdminService\";\nimport { User } from \"@/model/User\";\n\nexport default defineComponent({\n  data() {\n    const users: (User & { uid: string })[] = [];\n    const roles: { [role: string]: string[] } = {};\n    const selectedUsers: string[] = [];\n    //const selectedRoles: string[] = [];\n    const selectedRole = \"\";\n    return {\n      topic: \"\",\n      users,\n      roles,\n      selectedUsers,\n      // selectedRoles,\n      selectedRole,\n      loading: false,\n    };\n  },\n  async mounted() {\n    const adminService = new AdminService();\n    this.users = await adminService.getAllUsers();\n    this.roles = await adminService.getAllRoles();\n  },\n  methods: {\n    hasMandatoryFields() {\n      return this.selectedUsers.length > 0 && this.topic !== \"\";\n    },\n    async createTopic() {\n      const tokens = this.users\n        .filter((u) => this.selectedUsers.includes(u.uid))\n        .flatMap((u) =>\n          Object.keys(u.notificationTokens ? u.notificationTokens : {})\n        );\n      if (this.topic !== \"\" && tokens.length > 0) {\n        this.loading = true;\n        await new NotificationService().addToTopic(tokens, this.topic);\n        await new AdminService().saveTopic(this.topic, tokens);\n        this.loading = false;\n        this.$router.back();\n      }\n    },\n    toggleFromList(el: string, list: string[]) {\n      const i = list.indexOf(el);\n      if (i >= 0) {\n        list.splice(i, 1);\n      } else {\n        list.push(el);\n      }\n    },\n    toggleRole(role: string) {\n      // this.toggleFromList(role, this.selectedRoles);\n      // this.roles[role].forEach((r) =>\n      //   this.toggleFromList(r, this.selectedUsers)\n      // );\n      if (this.selectedRole === role) {\n        this.selectedRole = \"\";\n        this.selectedUsers = [];\n      } else {\n        this.selectedRole = role;\n        this.selectedUsers = this.roles[role];\n      }\n    },\n  },\n});\n","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-5d3e7a29\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { id: \"new_topic\" }\nconst _hoisted_2 = { class: \"desc\" }\nconst _hoisted_3 = { class: \"users_list\" }\nconst _hoisted_4 = [\"selected\", \"onClick\"]\nconst _hoisted_5 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"divider\" }, null, -1 /* HOISTED */))\nconst _hoisted_6 = { class: \"roles_list\" }\nconst _hoisted_7 = [\"selected\", \"onClick\"]\nconst _hoisted_8 = { class: \"desc\" }\nconst _hoisted_9 = [\"disabled\", \"loading\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, _toDisplayString(_ctx.$t.users), 1 /* TEXT */),\n    _createElementVNode(\"div\", _hoisted_3, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.users, (user) => {\n        return (_openBlock(), _createElementBlock(\"div\", {\n          class: \"toggable\",\n          key: user.uid,\n          selected: this.selectedUsers.includes(user.uid),\n          onClick: ($event: any) => (_ctx.toggleFromList(user.uid, this.selectedUsers))\n        }, _toDisplayString(user.info ? user.info.mail : user.uid), 9 /* TEXT, PROPS */, _hoisted_4))\n      }), 128 /* KEYED_FRAGMENT */))\n    ]),\n    _hoisted_5,\n    _createElementVNode(\"div\", _hoisted_6, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.roles, (role, key) => {\n        return (_openBlock(), _createElementBlock(\"div\", {\n          class: \"toggable\",\n          key: role,\n          selected: this.selectedRole === key,\n          onClick: ($event: any) => (_ctx.toggleRole(key))\n        }, _toDisplayString(key), 9 /* TEXT, PROPS */, _hoisted_7))\n      }), 128 /* KEYED_FRAGMENT */))\n    ]),\n    _createElementVNode(\"div\", _hoisted_8, _toDisplayString(_ctx.$t.topic), 1 /* TEXT */),\n    _createElementVNode(\"div\", {\n      class: \"input\",\n      contenteditable: \"true\",\n      inputmode: 'text',\n      onInput: _cache[0] || (_cache[0] = ($event: any) => (_ctx.topic = $event.target.innerText))\n    }, null, 32 /* HYDRATE_EVENTS */),\n    _createElementVNode(\"div\", {\n      class: \"submit_button\",\n      onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.createTopic && _ctx.createTopic(...args))),\n      disabled: !_ctx.hasMandatoryFields(),\n      loading: _ctx.loading\n    }, _toDisplayString(_ctx.$t.newTopic), 9 /* TEXT, PROPS */, _hoisted_9)\n  ]))\n}","import { User } from \"@/model/User\";\nimport { FirebaseDBService } from \"./FirebaseDBService\"\n\nexport class AdminService {\n\n    private db: FirebaseDBService;\n    // private store: Store<RootState>;\n\n    constructor() {\n        this.db = new FirebaseDBService();\n        // this.store = store;\n    }\n\n    async getAllUsers() {\n        const res = await this.db.readData<{ [uid: string]: User }>('users');\n        const users = [];\n        if (res) {\n            for (const uid in res) {\n                const user = { ...res[uid], uid };\n                users.push(user);\n            }\n        }\n        return users;\n    }\n\n    async getAllTopics() {\n        const res = await this.db.readData<{ [topic: string]: true }>('notifications/topics');\n        if (res) {\n            return Object.keys(res);\n        }\n        return [];\n    }\n\n    async getAllRoles(): Promise<{ [role: string]: string[]; }> {\n        const roles = await this.db.readData<{ [role: string]: Permission }>('permissions');\n        const formattedRoles: { [role: string]: string[] } = {};\n        if (roles) {\n            for (const role in roles) {\n                formattedRoles[role] = Object.keys(roles[role]);\n            }\n        }\n        return formattedRoles;\n    }\n\n    getTokensFromUsers(users: User[]) {\n        return users.flatMap((user) => {\n            if (user.notificationTokens) {\n                return Object.keys(user.notificationTokens);\n            }\n        });\n    }\n\n    async saveTopic(topic: string, tokens: string[]) {\n        const topicObj: { [topic: string]: true } = tokens.reduce(\n            (tObj: { [topic: string]: true }, t) => ({ ...tObj, [t]: true }), {}\n        );\n        this.db.writeData<{ [topic: string]: true }>(`notifications/topics/${topic}`, topicObj);\n    }\n\n}\n\nexport type Permission = {\n    [uid: string]: true;\n}\n","import { Message } from \"@/model/FcmMessage\";\n\nexport class NotificationService {\n\n    async sendNotification(message: Message) {\n        const myHeaders = new Headers();\n        myHeaders.append(\"Content-Type\", \"application/json\");\n\n        const raw = JSON.stringify(message);\n\n        const requestOptions = {\n            method: 'POST',\n            headers: myHeaders,\n            body: raw,\n        };\n\n        const res = await fetch(\"https://unruffled-liskov-633292.netlify.app/.netlify/functions/send\", requestOptions);\n        return await res.json();\n        \n    }\n    \n    async addToTopic(tokens: string[], topic: string) {\n        const myHeaders = new Headers();\n        myHeaders.append(\"Content-Type\", \"application/json\");\n        \n        const raw = JSON.stringify({tokens, topic});\n        \n        const requestOptions = {\n            method: 'POST',\n            headers: myHeaders,\n            body: raw,\n        };\n        \n        const res = await fetch(\"https://unruffled-liskov-633292.netlify.app/.netlify/functions/addToTopic\", requestOptions);\n        return await res.json();\n    }\n}","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"#new_topic[data-v-5d3e7a29] {\\n  display: flex;\\n  flex-direction: column;\\n}\\n#new_topic .desc[data-v-5d3e7a29] {\\n  margin: 4px;\\n  font-weight: 500;\\n  align-self: flex-start;\\n}\\n#new_topic .divider[data-v-5d3e7a29] {\\n  border-top: 1px #929292 solid;\\n  margin: 12px 8px;\\n}\\n#new_topic .input[data-v-5d3e7a29] {\\n  border: 1px #2c3e50 solid;\\n  border-radius: 8px;\\n  padding: 8px;\\n  margin: 6px;\\n  text-align: start;\\n  -webkit-appearance: none;\\n  outline: none;\\n}\\n#new_topic .users_list[data-v-5d3e7a29],\\n#new_topic .roles_list[data-v-5d3e7a29] {\\n  display: flex;\\n  flex-wrap: wrap;\\n}\\n#new_topic .users_list .toggable[data-v-5d3e7a29],\\n#new_topic .roles_list .toggable[data-v-5d3e7a29] {\\n  border: 1px #2c3e50 solid;\\n  border-radius: 8px;\\n  padding: 8px;\\n  margin: 6px;\\n  cursor: pointer;\\n}\\n#new_topic .users_list .toggable[selected=true][data-v-5d3e7a29],\\n#new_topic .roles_list .toggable[selected=true][data-v-5d3e7a29] {\\n  box-shadow: 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);\\n  z-index: 2;\\n  border: 1px #0047bb solid;\\n  background-color: #0047bb;\\n  color: #f0fbff;\\n}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import { render } from \"./NewTopic.vue?vue&type=template&id=5d3e7a29&scoped=true&ts=true\"\nimport script from \"./NewTopic.vue?vue&type=script&lang=ts\"\nexport * from \"./NewTopic.vue?vue&type=script&lang=ts\"\n\nimport \"./NewTopic.vue?vue&type=style&index=0&id=5d3e7a29&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/TomaccioD/Documents/other/protezione-civile/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5d3e7a29\"],['__file',\"src/views/NewTopic.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"5d3e7a29\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('5d3e7a29', __exports__)) {\n    api.reload('5d3e7a29', __exports__)\n  }\n  \n  module.hot.accept(\"./NewTopic.vue?vue&type=template&id=5d3e7a29&scoped=true&ts=true\", () => {\n    api.rerender('5d3e7a29', render)\n  })\n\n}\n\n\nexport default __exports__","export { default } from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[1]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./NewTopic.vue?vue&type=script&lang=ts\"; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[1]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./NewTopic.vue?vue&type=script&lang=ts\"","export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[1]!../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[4]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./NewTopic.vue?vue&type=template&id=5d3e7a29&scoped=true&ts=true\"","export * from \"-!../../node_modules/vue-style-loader/index.js??clonedRuleSet-22.use[0]!../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./NewTopic.vue?vue&type=style&index=0&id=5d3e7a29&lang=scss&scoped=true\"","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./NewTopic.vue?vue&type=style&index=0&id=5d3e7a29&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"0bd71a9a\", content, false, {\"sourceMap\":false,\"shadowMode\":false});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./NewTopic.vue?vue&type=style&index=0&id=5d3e7a29&lang=scss&scoped=true\", function() {\n     var newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./NewTopic.vue?vue&type=style&index=0&id=5d3e7a29&lang=scss&scoped=true\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}"],"names":["defineComponent","NotificationService","AdminService","data","users","roles","selectedUsers","selectedRole","topic","loading","mounted","adminService","getAllUsers","getAllRoles","methods","hasMandatoryFields","length","createTopic","tokens","filter","u","includes","uid","flatMap","Object","keys","notificationTokens","addToTopic","saveTopic","$router","back","toggleFromList","el","list","i","indexOf","splice","push","toggleRole","role","toDisplayString","_toDisplayString","createElementVNode","_createElementVNode","renderList","_renderList","Fragment","_Fragment","openBlock","_openBlock","createElementBlock","_createElementBlock","pushScopeId","_pushScopeId","popScopeId","_popScopeId","_withScopeId","n","_hoisted_1","id","_hoisted_2","class","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","render","_ctx","_cache","$props","$setup","$data","$options","$t","user","key","selected","onClick","$event","info","mail","contenteditable","inputmode","onInput","target","innerText","args","disabled","newTopic","FirebaseDBService","constructor","db","res","readData","getAllTopics","formattedRoles","getTokensFromUsers","topicObj","reduce","tObj","t","writeData","sendNotification","message","myHeaders","Headers","append","raw","JSON","stringify","requestOptions","method","headers","body","fetch","json"],"sourceRoot":""}